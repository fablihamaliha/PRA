â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  DEPLOYMENT CHECKLIST - PUSH TO GITHUB WITH ADMIN SECURITY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Use this checklist when pushing to GitHub and deploying to Raspberry Pi
with the new admin security features.


ğŸ“‹ PRE-COMMIT CHECKLIST
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Verify .env is NOT staged for commit
   [ ] Run: git status
   [ ] Confirm .env is NOT in "Changes to be committed"
   [ ] If it is: git reset .env

2. Verify admin files are ignored by git
   [ ] Run: git status --ignored
   [ ] Confirm these are in "Ignored files:":
       - pra/routes/analytics_routes.py
       - pra/templates/admin_security_dashboard.html
       - pra/templates/analytics_dashboard.html
       - ADMIN_SECURITY_IMPLEMENTATION.md
       - ADMIN_QUICK_START.txt

3. Verify .gitignore is properly configured
   [ ] Open .gitignore
   [ ] Confirm these lines exist:
       âœ“ .env
       âœ“ pra/templates/admin_*.html
       âœ“ pra/templates/analytics_*.html
       âœ“ pra/routes/analytics_routes.py
       âœ“ ADMIN_*.md
       âœ“ ADMIN_*.txt

4. Review files to be committed
   [ ] Run: git diff --cached
   [ ] NO admin-related files should appear
   [ ] NO .env or secrets should appear
   [ ] Only safe public files included


ğŸ” PRODUCTION .env SETUP (Raspberry Pi)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. SSH to Raspberry Pi
   [ ] ssh pi@192.168.1.68

2. Backup current .env
   [ ] cp /path/to/.env /path/to/.env.backup

3. Add admin security variables to .env
   [ ] Add: ENABLE_ADMIN_DASHBOARD=true
   [ ] Add: ADMIN_DASHBOARD_PATH=<generate-random-uuid>
   [ ] Optional: ADMIN_ALLOWED_IPS=192.168.1.68

   Example random UUID for path:
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ADMIN_DASHBOARD_PATH=a7f3k9m2x5b8c1d4e6g0h7            â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   To generate random UUID online:
   https://www.uuidgenerator.net/ (remove dashes)

4. Save the admin path somewhere safe
   [ ] Copy ADMIN_DASHBOARD_PATH value to password manager
   [ ] Update browser bookmarks with new URL


ğŸš€ COMMIT AND PUSH TO GITHUB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Stage changes
   [ ] git add .

2. Verify AGAIN no secrets staged
   [ ] git status
   [ ] git diff --cached --name-only
   [ ] Review list carefully

3. Commit with descriptive message
   [ ] git commit -m "Add multi-layer admin security features

   - Environment-based feature toggle for admin dashboard
   - Obfuscated route paths with custom configuration
   - Optional IP whitelist for admin access
   - Hide admin templates and routes from public repo
   - Update .gitignore for admin security files

   ğŸ¤– Generated with Claude Code"

4. Push to GitHub
   [ ] git push origin master


ğŸ¯ AUTOMATIC DEPLOYMENT (GitHub Actions)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

After pushing, GitHub Actions will automatically:

1. Verify repository owner
   - Only fablihamaliha/PRA can run workflow
   - Prevents forks from deploying

2. Build and push Docker image
   - CI workflow builds image
   - Pushes to ghcr.io/fablihamaliha/pra

3. Deploy to Raspberry Pi
   - Self-hosted runner on Pi starts deployment
   - Pulls latest image
   - Runs migrations
   - Restarts application

Monitor deployment:
   [ ] Watch GitHub Actions: https://github.com/fablihamaliha/PRA/actions
   [ ] Should see CI and Deploy workflows running


âœ… POST-DEPLOYMENT VERIFICATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Check application logs
   [ ] SSH to Pi: ssh pi@192.168.1.68
   [ ] View logs: docker logs pra-app | tail -50
   [ ] Look for: "Admin dashboard enabled at path: /a7f3k9m2..."

2. Verify admin dashboard is accessible
   [ ] Open: https://skincares.work/<your-admin-path>/dashboard
   [ ] Should redirect to login if not authenticated
   [ ] Login with admin@admin.com
   [ ] Should see Security Operations Center dashboard

3. Verify old route returns 404
   [ ] Try: https://skincares.work/analytics/dashboard
   [ ] Should return: 404 Not Found (if you changed path)

4. Test regular user access
   [ ] Login with non-admin account
   [ ] Should redirect to regular dashboard
   [ ] Should NOT have access to admin features

5. Check GitHub repository
   [ ] Visit: https://github.com/fablihamaliha/PRA
   [ ] Verify admin files NOT visible:
       - No admin templates in pra/templates/
       - No analytics_routes.py in pra/routes/
       - No ADMIN_*.md documentation files


ğŸ›¡ï¸ SECURITY VERIFICATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. Test unauthorized access
   [ ] From different device/network
   [ ] Try: https://skincares.work/<admin-path>/dashboard
   [ ] Without auth: Should require login
   [ ] With non-admin account: Should get 403 Forbidden

2. Verify IP whitelist (if enabled)
   [ ] Access from non-whitelisted IP
   [ ] Should get 403 Forbidden

3. Test fork protection
   [ ] Fork the repository (or imagine someone does)
   [ ] Try to run GitHub Actions workflow
   [ ] Should fail at "Verify Repository Owner" step

4. Verify secrets not exposed
   [ ] Browse GitHub repo files
   [ ] Search for "ENABLE_ADMIN_DASHBOARD"
   [ ] Should only appear in .env.example with value=false


ğŸ” TROUBLESHOOTING
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Problem: CI/CD workflow fails
  â†’ Check GitHub Actions logs
  â†’ Verify repository ownership verification
  â†’ Check Docker image build logs

Problem: Admin dashboard not accessible after deploy
  â†’ SSH to Pi and check logs
  â†’ Verify ENABLE_ADMIN_DASHBOARD=true in .env
  â†’ Verify ADMIN_DASHBOARD_PATH matches URL
  â†’ Restart: docker restart pra-app

Problem: Admin dashboard accessible at old /analytics path
  â†’ This is OK if you didn't change ADMIN_DASHBOARD_PATH
  â†’ To use obfuscated path, set new value in .env and restart

Problem: Git trying to commit admin files
  â†’ Run: git reset HEAD <file>
  â†’ Verify file is in .gitignore
  â†’ Run: git status --ignored to confirm

Problem: Application won't start after deployment
  â†’ Check logs: docker logs pra-app
  â†’ Look for Python import errors or config issues
  â†’ Verify all environment variables are set
  â†’ Check database connection


ğŸ“ ROLLBACK PROCEDURE (If Needed)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

If something goes wrong:

1. Revert to previous commit
   [ ] git log (find previous commit hash)
   [ ] git revert <commit-hash>
   [ ] git push origin master

2. Or restore .env backup
   [ ] SSH to Pi
   [ ] cp /path/to/.env.backup /path/to/.env
   [ ] docker restart pra-app

3. Or manually disable admin security
   [ ] Edit .env
   [ ] Set: ENABLE_ADMIN_DASHBOARD=false
   [ ] docker restart pra-app


ğŸ“ QUICK REFERENCE
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Key Commands:
  Check git status:        git status --ignored
  View staged changes:     git diff --cached
  SSH to Pi:               ssh pi@192.168.1.68
  Check app logs:          docker logs pra-app
  Restart app:             docker restart pra-app

Key URLs:
  Production:              https://skincares.work
  Admin Dashboard:         https://skincares.work/<your-path>/dashboard
  GitHub Actions:          https://github.com/fablihamaliha/PRA/actions
  GitHub Repository:       https://github.com/fablihamaliha/PRA

Key Files:
  Environment config:      .env (on Pi, NOT in git)
  Git ignore rules:        .gitignore
  Analytics routes:        pra/routes/analytics_routes.py
  Admin templates:         pra/templates/admin_*.html


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  READY TO DEPLOY? âœ“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

If all checkboxes above are checked, you're ready to:
  1. git add .
  2. git commit -m "Your commit message"
  3. git push origin master

The rest happens automatically via CI/CD!


Last Updated: 2026-01-08
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
